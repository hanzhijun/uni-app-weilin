(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/detail/index"],{"37b5":function(e,n,t){},"4dda":function(e,n,t){"use strict";t.r(n);var o=t("7411"),i=t("7beb");for(var a in i)"default"!==a&&function(e){t.d(n,e,function(){return i[e]})}(a);t("6a2c");var c=t("2877"),r=Object(c["a"])(i["default"],o["a"],o["b"],!1,null,null,null);n["default"]=r.exports},"6a2c":function(e,n,t){"use strict";var o=t("37b5"),i=t.n(o);i.a},7411:function(e,n,t){"use strict";var o=function(){var e=this,n=e.$createElement;e._self._c},i=[];t.d(n,"a",function(){return o}),t.d(n,"b",function(){return i})},"741b":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=t("2a7e"),i=o.warnRuleData,a=o.warnStateData,c=o.setCookie,r=o.getCookie,s=o.myAjax2,u=o.getWarnCookie,l=o.changeWarnToThis,d={data:function(){return{title:"Smater 守护",showToast:0,toastTxt:"",loading:0,confirm:0,userInfo:null,deviceNos:"",accessToken:null,breathNum:"--",deviceStatus:null,heartNum:"--",markTime:null,motionNum:null,timer:null,device:"",deviceTimes:"",deviceStart:"",deviceEnd:"",heart:"",heartUp:"",heartDown:"",breath:"",breathUp:"",breathDown:"",motion:"",motionTimes:"",motionStart:"",motionEnd:"",warnNing:0,warningText:"",warnNo:"",warnDeviceTime:"",warnHeartTime:"",warnBreathTime:"",warnMotionTime:"",firstTimes:0,motionState:!1,motionTimer:null}},onLoad:function(){var n=this,t=r("accessToken"),o=r("deviceNos"),i=r("username");t?o?(l(n),u(n),n.userInfo=i,n.accessToken=t,n.deviceNos=o,n.getActual(),n.setSocketTask(),n.timer=setInterval(function(){n.getActual()},5e3),n.motionTimer=setInterval(function(){n.motionState=!n.motionState},1e3)):e.redirectTo({url:"../code/index"}):e.redirectTo({url:"../login/index"})},onLaunch:function(){},onShow:function(){l(this)},onHide:function(){},onUnload:function(){},methods:{getActual:function(){var n={deviceNos:this.deviceNos},t=this;s("post","/device/physiology/actual",n,function(n){"10000"==n.retCode?(o.checkWarn(t,n),t.breathNum=n.successData[0].breath,t.deviceStatus=n.successData[0].deviceStatus,t.heartNum=n.successData[0].heart,t.markTime=n.successData[0].markTime,t.motionNum=n.successData[0].motion):(c("accessToken",""),c("username",""),e.redirectTo({url:"../login/index"}))},function(e){})},linkRecord:function(){e.navigateTo({url:"../record/index"})},linkSetting:function(){e.navigateTo({url:"../setting/index"})},setSocketTask:function(e){if("close"!=e){var n=o.getCookie("accessToken"),t=this;console.log("建立连接!"," at pages\\detail\\index.vue:261"),wx.connectSocket({url:"ws://stream.darma.cn:17004/ws",sluccess:function(){console.log("连接成功..."," at pages\\detail\\index.vue:265")},fail:function(){console.log("连接失败..."," at pages\\detail\\index.vue:268")}}),wx.onSocketOpen(function(){console.log("连接成功!"," at pages\\detail\\index.vue:273");var e={msgType:"login",data:{token:n,deviceNo:t.deviceNos}};wx.sendSocketMessage({data:JSON.stringify(e)})}),wx.onSocketMessage(function(e){var n=JSON.parse(e.data).msgType;if("deviceStatus"==n){console.log(e.data," at pages\\detail\\index.vue:298");var o=JSON.parse(e.data).data.deviceStatus;"3"==o?(a.warnHeartTime=null,a.warnBreathTime=null,a.warnMotionTime=null,t.warnHeartTime=null,t.warnBreathTime=null,t.warnMotionTime=null,i.device&&(console.log("离床已记录，以此时间为基准开始计算报警数据"," at pages\\detail\\index.vue:309"),a.warnDeviceTime=Date.parse(new Date),t.warnDeviceTime=a.warnDeviceTime)):"4"==o?(a.warnDeviceTime=null,t.warnDeviceTime=null,console.log("解除离床报警计算数据"," at pages\\detail\\index.vue:317")):"5"!=o&&"6"!=o||(a.warnDeviceTime=null,a.warnHeartTime=null,a.warnBreathTime=null,a.warnMotionTime=null,t.warnDeviceTime=null,t.warnHeartTime=null,t.warnBreathTime=null,t.warnMotionTime=null)}}),wx.onSocketError(function(){console.log("websocket连接失败！"," at pages\\detail\\index.vue:332")}),wx.onSocketClose(function(e){console.log("WebSocket 已关闭！"," at pages\\detail\\index.vue:335")})}else wx.closeSocket()},audioPause:function(){o.audioPause(this)},openConfirmBox1:function(){this.confirm=1},openConfirmBox2:function(){this.confirm=2},openConfirmBox3:function(){this.confirm=3},closeConfirmBox:function(){this.confirm=0},loginOut1:function(){this.setSocketTask("close"),c("accessToken",""),c("username",""),c("deviceNos",""),c("warnRule",""),this.confirm=0,clearInterval(this.timer),e.redirectTo({url:"../login/index"})},loginOut2:function(){this.setSocketTask("close"),c("deviceNos",""),this.confirm=0,clearInterval(this.timer),e.redirectTo({url:"../code/index"})}}};n.default=d}).call(this,t("6e42")["default"])},"7beb":function(e,n,t){"use strict";t.r(n);var o=t("741b"),i=t.n(o);for(var a in o)"default"!==a&&function(e){t.d(n,e,function(){return o[e]})}(a);n["default"]=i.a}},[["9f18","common/runtime","common/vendor"]]]);
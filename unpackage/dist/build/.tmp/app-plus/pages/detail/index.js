(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/detail/index"],{1463:function(e,a,t){"use strict";t.r(a);var n=t("a94a"),o=t("3cac");for(var i in o)"default"!==i&&function(e){t.d(a,e,function(){return o[e]})}(i);t("96b9");var s=t("2877"),c=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);a["default"]=c.exports},2639:function(e,a,t){},"3cac":function(e,a,t){"use strict";t.r(a);var n=t("44a6"),o=t.n(n);for(var i in n)"default"!==i&&function(e){t.d(a,e,function(){return n[e]})}(i);a["default"]=o.a},"44a6":function(e,a,t){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=t("a4c9"),o=n.getCookie,i=n.setCookie,s=(n.myAjax,n.myAjax2),c=wx.getBackgroundAudioManager(),u={data:function(){return{title:"微麟守护者",userInfo:null,deviceNos:"",accessToken:null,breath:"--",deviceStatus:null,heart:"--",markTime:null,motion:null,timer:null,toast:0,toastTxt:"",loading:0}},onLoad:function(){},onLaunch:function(){console.log("App Launch-detail"," at pages\\detail\\index.vue:89")},onShow:function(){var a=this,t=o("accessToken"),i=o("deviceNos"),s=o("username");t?i?(n.changeWarn(a,c),n.getWarnCookie(a),a.userInfo=s,a.accessToken=t,a.deviceNos=i,a.getActual(),a.setSocketTask(),this.timer=setInterval(function(){a.getActual()},1e4)):e.redirectTo({url:"../code/index"}):e.redirectTo({url:"../login/index"})},onHide:function(){console.log("App Hide-detail"," at pages\\detail\\index.vue:118")},methods:{getActual:function(){var a={deviceNos:this.deviceNos},t=this;s("post","/device/physiology/actual",a,function(a){if("10000"==a.retCode){if(3==a.successData[0].deviceStatus&&t.leaveTime){var n=Date.parse(new Date);n-t.leaveTime>12e3&&0==t.warning&&(console.log(n-t.leaveTime," at pages\\detail\\index.vue:138"),t.warningText="离床报警已触发",t.warning=1,c.title="报警",c.epname="报警",c.singer="报警",c.coverImgUrl="",c.src="/static/warning.mp3",c.onEnded(function(){c.src="/static/warning.mp3?time="+Date.parse(new Date)}))}t.breath=a.successData[0].breath,t.deviceStatus=a.successData[0].deviceStatus,t.heart=a.successData[0].heart,t.markTime=a.successData[0].markTime,t.motion=a.successData[0].motion}else console.log("未知错误，请重新登录"," at pages\\detail\\index.vue:159"),i("accessToken",""),i("username",""),e.redirectTo({url:"../login/index"})},function(e){console.log(JSON.stringify(e)," at pages\\detail\\index.vue:168")})},audioPause:function(){n.audioPause(this,c)},linkRecord:function(){e.navigateTo({url:"../record/index"})},linkSetting:function(){e.navigateTo({url:"../setting/index"})},setSocketTask:function(){var e=n.getCookie("accessToken"),a=this;console.log("建立连接!"," at pages\\detail\\index.vue:192"),wx.connectSocket({url:"ws://stream.darma.cn:17004/ws",sluccess:function(){console.log("连接成功..."," at pages\\detail\\index.vue:196")},fail:function(){console.log("连接失败..."," at pages\\detail\\index.vue:199")}}),wx.onSocketOpen(function(){console.log("连接成功!"," at pages\\detail\\index.vue:204");var t={msgType:"login",data:{token:e,deviceNo:a.deviceNos}};wx.sendSocketMessage({data:JSON.stringify(t)})}),wx.onSocketMessage(function(e){"healthBreathData"!=JSON.parse(e.data).msgType&&"deviceStatus"!=JSON.parse(e.data).msgType||console.log(e.data," at pages\\detail\\index.vue:223"),"deviceStatus"==JSON.parse(e.data).msgType&&("3"==JSON.parse(e.data).data.deviceStatus?(console.log("离床已记录，以此时间为基准开始计算报警数据"," at pages\\detail\\index.vue:232"),a.leaveTime=Date.parse(new Date)):(a.leaveTime=null,console.log("解除离床报警计算数据"," at pages\\detail\\index.vue:236")))}),wx.onSocketError(function(){console.log("websocket连接失败！"," at pages\\detail\\index.vue:242")})}}};a.default=u}).call(this,t("6e42")["default"])},"96b9":function(e,a,t){"use strict";var n=t("2639"),o=t.n(n);o.a},a94a:function(e,a,t){"use strict";var n=function(){var e=this,a=e.$createElement;e._self._c},o=[];t.d(a,"a",function(){return n}),t.d(a,"b",function(){return o})}},[["1b6a","common/runtime","common/vendor"]]]);